# zksync-os-sequencer
New sequencer implementation for zksync-os

## Important glossary (WIP)

* `Block` vs `Batch` - One vm run = one block. One FRI proof = one L1 commit = one batch.

Important: currently zksync-os uses term `batch` for blocks (e.g. `run_batch` etc.). 
Also, return type of a block is `BatchOutput` - which represents a block in our case. 
todo: use `use BatchOutput as BlockOutput` in this repo to avoid confusion.

## Running with L1

This repo includes a pre-setup L1 state `zkos-l1-state.json` that can be loaded into `anvil`. The state was generated by `zkstack init` and essentially consists of all L1 contracts deployed and initialized with L2 genesis. The state comes with some L1 priority transactions that were generated by the old genesis logic and are hence failing in the new implementation.

Before you run an L1 node, make sure you have a 1.x version of `anvil` installed (see [foundry guide](https://getfoundry.sh/)). Then:

```
$ anvil --load-state zkos-l1-state.json --port 8545
...
Listening on 127.0.0.1:8545
...
```

You can now start ZKsync OS server in parallel:
```
$ cargo run --release
...
INFO zksync_os_l1_watcher: initializing L1 watcher bridgehub_address=0x4b37536b9824c4a4cf3d15362135e346adb7cb9c chain_id=270 next_l1_block=0
...
```
